# DataExporter - IDA 数据导出插件
一款轻量高效的 IDA Pro 插件，用于快速导出指定地址范围的二进制数据/指令数据，支持多种格式输出，简化逆向分析中的数据提取流程。

## 插件介绍
### 核心功能
- 支持设置自定义数据起始/结束地址，自动校验地址有效性
- 多种数据格式导出：
  - 单字节（Byte）格式
  - 双字节（Word，小端序）格式
  - 四字节（Dword，小端序）格式
  - 八字节（Qword，小端序）格式
  - 十六进制字符串（含纯字符/带0x前缀/空格分隔三种样式）
  - 指令末尾1字节/4字节/8字节（不足自动补0，适用于数据编码在代码段，根据指令特征提取）
- 附带 C/C++ / Python 数组格式输出，可直接复制到项目中使用
- 右键菜单按需显示：仅当完整设置起始+结束地址后，才显示导出功能组

### 支持环境
- IDA Pro 9.0（兼容 IDA Pro 7.0+ 大部分版本）
- Python 3.x（IDA 自带内嵌 Python 环境即可，无需额外配置）

## 安装方式
### 步骤1：获取插件文件
下载 `data_exporter.py` 插件文件（可直接复制插件代码保存为该文件名）。

### 步骤2：放置插件到IDA目录
根据操作系统，将 `data_exporter.py` 放入对应的 IDA 插件目录：

| 操作系统 | 插件目录路径 |
|----------|--------------|
| Windows  | `IDA安装目录\plugins\` |
| macOS    | `/Applications/IDA Pro x.x/idaq.app/Contents/MacOS/plugins/` |
| Linux    | `/opt/ida-x.x/plugins/` |

### 步骤3：生效插件
1. 重启 IDA Pro，插件会自动加载（无需手动启用）
2. 验证加载：启动后打开 Output 窗口，可看到 `[Data Exporter] 插件已加载` 提示

## 使用方式

### 1. 设置起始地址
- 方法1（右键菜单）：在反汇编/十六进制窗口，右键点击目标地址 → `Data Exporter -> 设置起始地址`
- 方法2（快捷键）：选中地址后按下 `Ctrl+Shift+S`
- 提示：设置成功后，Output 窗口显示 `[Data Exporter] 起始地址设置为: 0xXXXXXXXX`

### 2. 设置结束地址
- 方法1（右键菜单）：右键点击目标地址 → `Data Exporter -> 设置结束地址`
- 方法2（快捷键）：选中地址后按下 `Ctrl+Shift+E`
- 提示：设置成功后，Output 窗口显示 `[Data Exporter] 结束地址设置为: 0xXXXXXXXX`

### 3. 查看地址信息
- 操作：右键菜单 → `Data Exporter -> 显示当前设置`
- 效果：Output 窗口显示起始地址、结束地址及数据总长度

### 4. 导出数据
> 注意：仅当完整设置起始+结束地址后，右键菜单才会显示导出功能组

- 操作：右键菜单 → `Data Exporter`
- 支持的导出选项：
  1. `导出为单字节格式`：按字节拆分，每行16个数据
  2. `导出为双字节格式`：小端序组合，每行8个数据（自动对齐2字节边界）
  3. `导出为四字节格式`：小端序组合，每行4个数据（自动对齐4字节边界）
  4. `导出为八字节格式`：小端序组合，每行4个数据（自动对齐8字节边界）
  5. `导出为十六进制字符串`：3种样式 + C/C++/Python 数组
  6. `导出指令后1字节`：提取每条指令末尾1字节
  7. `导出指令后4字节`：提取每条指令末尾4字节（不足补0）
  8. `导出指令后8字节`：提取每条指令末尾8字节（不足补0）
- 效果：导出结果在 Output 窗口显示，可直接复制使用

### 5. 清除地址设置
- 操作：右键菜单 → `Data Exporter -> 清除地址设置`
- 效果：清空已设置地址，导出功能组隐藏

### 示例效果
以「导出为十六进制字符串」为例，Output 窗口输出如下：

```bash
[Data Exporter] 起始地址设置为: 0x00401707
[Data Exporter] 结束地址设置为: 0x00401721

[Data Exporter] 十六进制字符串导出 (0x00401707 - 0x00401721)[27 字节]:
================================================================================
十六进制数据:
E8 30 2A 00 00 C7 04 24 6E 60 40 00 E8 2C 2A 00 00 A1 BC 91 40 00 89 44 24 08 C7
E8302A0000C704246E604000E82C2A0000A1BC91400089442408C7
0xE8,0x30,0x2A,0x00,0x00,0xC7,0x04,0x24,0x6E,0x60,0x40,0x00,0xE8,0x2C,0x2A,0x00,0x00,0xA1,0xBC,0x91,0x40,0x00,0x89,0x44,0x24,0x08,0xC7

--------------------------------------------------------------------------------
C/C++ 数组格式:
unsigned char data[27] = {
    0xE8, 0x30, 0x2A, 0x00, 0x00, 0xC7, 0x04, 0x24, 0x6E, 0x60, 0x40, 0x00, 0xE8, 0x2C, 0x2A, 0x00,
    0x00, 0xA1, 0xBC, 0x91, 0x40, 0x00, 0x89, 0x44, 0x24, 0x08, 0xC7
};

--------------------------------------------------------------------------------
python 数组格式:
data = [
    0xE8, 0x30, 0x2A, 0x00, 0x00, 0xC7, 0x04, 0x24, 0x6E, 0x60, 0x40, 0x00, 0xE8, 0x2C, 0x2A, 0x00,
    0x00, 0xA1, 0xBC, 0x91, 0x40, 0x00, 0x89, 0x44, 0x24, 0x08, 0xC7
]
================================================================================
```